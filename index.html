<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FoodLink | Intelligent Rescue System by Amrutha AL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap');
        
        :root {
            --primary: #10b981;
            --primary-dark: #065f46;
            --accent: #f97316;
            --surface: #ffffff;
            --bg: #f1f5f9;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #0f172a;
            color: #1e293b;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        /* Mobile Frame Styling */
        .phone-wrapper {
            width: 380px;
            height: 780px;
            background: #1e293b;
            padding: 12px;
            border-radius: 50px;
            box-shadow: 0 50px 100px -20px rgba(0,0,0,0.7);
            position: relative;
            border: 4px solid #334155;
        }

        .phone-inner {
            width: 100%;
            height: 100%;
            background: var(--bg);
            border-radius: 38px;
            overflow: hidden;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .notch {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 140px;
            height: 28px;
            background: #1e293b;
            border-bottom-left-radius: 18px;
            border-bottom-right-radius: 18px;
            z-index: 100;
        }

        /* UI Components */
        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.05);
        }

        .nav-item {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .nav-item.active {
            color: var(--primary);
            transform: translateY(-4px);
        }

        .nav-item.active::after {
            content: '';
            position: absolute;
            bottom: -8px;
            width: 4px;
            height: 4px;
            background: var(--primary);
            border-radius: 50%;
        }

        .btn-action {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            transition: all 0.2s;
        }

        .btn-action:active {
            transform: scale(0.96);
        }

        .quality-tag {
            font-size: 10px;
            font-weight: 800;
            padding: 4px 10px;
            border-radius: 99px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* View Animations */
        .view-fade {
            animation: fadeIn 0.4s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Custom Scrollbar */
        .scroll-container::-webkit-scrollbar { width: 0; }
    </style>
</head>
<body>

<div class="phone-wrapper">
    <div class="notch"></div>
    
    <div class="phone-inner">
        <!-- Persistent App Header -->
        <header class="bg-white px-6 pt-12 pb-4 flex justify-between items-center shadow-sm z-10">
            <div>
                <h1 class="text-xl font-extrabold text-emerald-600 tracking-tight">FoodLink</h1>
                <p id="sub-header" class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Innovation by Amrutha</p>
            </div>
            <div id="connection-status" class="flex items-center space-x-1">
                <div class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></div>
                <span class="text-[10px] font-bold text-slate-400">LIVE</span>
            </div>
        </header>

        <!-- Main Content Area -->
        <main id="app-view" class="flex-1 overflow-y-auto scroll-container p-5">
            <!-- Dynamic Content -->
        </main>

        <!-- Bottom Navigation -->
        <footer class="bg-white/80 backdrop-blur-md border-t border-slate-100 h-20 flex justify-around items-center px-4 pb-2 z-10">
            <button onclick="switchView('donor')" class="nav-item active flex flex-col items-center text-slate-400" id="nav-donor">
                <i class="fa-solid fa-plus-circle text-xl mb-1"></i>
                <span class="text-[10px] font-bold">DONATE</span>
            </button>
            <button onclick="switchView('rescue')" class="nav-item flex flex-col items-center text-slate-400" id="nav-rescue">
                <i class="fa-solid fa-truck-ramp-box text-xl mb-1"></i>
                <span class="text-[10px] font-bold">RESCUE</span>
            </button>
            <button onclick="switchView('admin')" class="nav-item flex flex-col items-center text-slate-400" id="nav-admin">
                <i class="fa-solid fa-chart-line text-xl mb-1"></i>
                <span class="text-[10px] font-bold">METRICS</span>
            </button>
        </footer>
    </div>
</div>

<script>
    // State
    let listings = [
        { id: 1, name: 'Premium Veg Buffet', qty: '25 Servings', loc: 'Orchid Banquet', quality: 94, type: 'Human', night: true, status: 'Open' },
        { id: 2, name: 'Artisan Bread Mix', qty: '8 kg', loc: 'Bakers Street', quality: 62, type: 'Animal', night: false, status: 'Open' }
    ];

    const appView = document.getElementById('app-view');
    const subHeader = document.getElementById('sub-header');

    function switchView(view) {
        // Update Navigation UI
        document.querySelectorAll('.nav-item').forEach(btn => btn.classList.remove('active'));
        document.getElementById(`nav-${view}`).classList.add('active');

        if (view === 'donor') renderDonor();
        else if (view === 'rescue') renderRescue();
        else if (view === 'admin') renderAdmin();
    }

    // --- Donor Portal ---
    function renderDonor() {
        subHeader.innerText = "Donor Portal";
        appView.innerHTML = `
            <div class="view-fade">
                <div class="mb-6">
                    <h2 class="text-xl font-extrabold text-slate-800 leading-tight">Post Surplus</h2>
                    <p class="text-xs text-slate-500 font-medium">Quality Check Unit (QCU) will process your entry.</p>
                </div>

                <div class="glass-card p-5 space-y-4 mb-8">
                    <div>
                        <label class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Food Item</label>
                        <input id="in-name" type="text" placeholder="e.g. Fresh Meals" class="w-full mt-1 bg-transparent border-b border-slate-200 py-2 text-sm font-semibold focus:outline-none focus:border-emerald-500 transition-colors">
                    </div>
                    <div>
                        <label class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Quantity</label>
                        <input id="in-qty" type="text" placeholder="e.g. 20 Plates" class="w-full mt-1 bg-transparent border-b border-slate-200 py-2 text-sm font-semibold focus:outline-none focus:border-emerald-500 transition-colors">
                    </div>
                    
                    <div class="flex items-center justify-between py-2">
                        <div>
                            <p class="text-sm font-bold text-slate-700">Night Rescue Mode</p>
                            <p class="text-[10px] text-slate-400">Route to 24/7 Smart Hubs</p>
                        </div>
                        <input id="in-night" type="checkbox" class="w-5 h-5 accent-emerald-500">
                    </div>

                    <button onclick="processDonation()" class="btn-action w-full py-4 rounded-2xl text-white font-bold text-sm shadow-lg shadow-emerald-200">
                        ANALYZE & DISPATCH
                    </button>
                </div>

                <h3 class="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4">Live Listings</h3>
                <div id="listings-container" class="space-y-3">
                    ${renderCards(true)}
                </div>
            </div>
        `;
    }

    async function processDonation() {
        const name = document.getElementById('in-name').value;
        const qty = document.getElementById('in-qty').value;
        const isNight = document.getElementById('in-night').checked;

        if(!name || !qty) return showModal("Action Required", "Please enter food details.");

        // QCU Algorithm Simulation
        const score = Math.floor(Math.random() * 60) + 40; 
        let route = score >= 75 ? 'Human' : (score >= 50 ? 'Animal' : 'Compost');

        if(score < 50) {
            const allow = await showModal("Quality Alert", `Score: ${score}/100. Unsafe for food banks. Redirect to <b>Compost Unit</b>?`, true);
            if(!allow) return;
        }

        listings.unshift({
            id: Date.now(),
            name: name,
            qty: qty,
            loc: 'Current Location',
            quality: score,
            type: route,
            night: isNight,
            status: 'Open'
        });

        showModal("QCU Verified", `Score: ${score}/100<br>Target: <b>${route.toUpperCase()}</b>`);
        renderDonor();
    }

    // --- Rescue Portal ---
    function renderRescue() {
        subHeader.innerText = "Rescue Network";
        const available = listings.filter(l => l.status === 'Open');
        
        appView.innerHTML = `
            <div class="view-fade">
                <div class="bg-slate-900 rounded-3xl p-5 mb-6 text-white shadow-xl">
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-[10px] font-bold bg-emerald-500 px-2 py-1 rounded">ACTIVE</span>
                        <i class="fa-solid fa-satellite-dish text-emerald-400"></i>
                    </div>
                    <p class="text-2xl font-black">Ready to Rescue</p>
                    <p class="text-[10px] opacity-60 mt-1">Found ${available.length} requests in your radius.</p>
                </div>

                <div class="space-y-4">
                    ${available.length ? renderCards(false) : '<p class="text-center py-20 text-slate-400 text-sm">Waiting for new surplus...</p>'}
                </div>
            </div>
        `;
    }

    function handleClaim(id) {
        const item = listings.find(l => l.id == id);
        if(item) {
            item.status = 'Claimed';
            showModal("Route Locked", `Pickup at: <b>${item.loc}</b><br>${item.night ? 'ðŸš¨ Alert: Deliver to 24/7 Smart Hub' : 'Deliver to City Food Bank.'}`);
            renderRescue();
        }
    }

    // --- Admin Metrics ---
    function renderAdmin() {
        subHeader.innerText = "System Intelligence";
        const total = listings.length;
        const co2 = (listings.filter(l => l.status === 'Claimed').length * 2.8).toFixed(1);

        appView.innerHTML = `
            <div class="view-fade">
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="glass-card p-5">
                        <p class="text-[10px] font-bold text-slate-400 uppercase">Impact</p>
                        <p class="text-2xl font-black text-emerald-600">${co2}kg</p>
                        <p class="text-[9px] text-slate-500 font-bold">CO2 DIVERTED</p>
                    </div>
                    <div class="glass-card p-5">
                        <p class="text-[10px] font-bold text-slate-400 uppercase">Success</p>
                        <p class="text-2xl font-black text-orange-500">98%</p>
                        <p class="text-[9px] text-slate-500 font-bold">RECOVERY RATE</p>
                    </div>
                </div>

                <div class="glass-card p-6 mb-6 overflow-hidden relative">
                    <div class="relative z-10">
                        <h4 class="text-sm font-bold text-slate-800 mb-2">Technical Efficiency</h4>
                        <div class="flex items-end space-x-2 h-20">
                            <div class="bg-emerald-100 w-full h-[40%] rounded-t-lg"></div>
                            <div class="bg-emerald-200 w-full h-[60%] rounded-t-lg"></div>
                            <div class="bg-emerald-300 w-full h-[50%] rounded-t-lg"></div>
                            <div class="bg-emerald-400 w-full h-[85%] rounded-t-lg"></div>
                            <div class="bg-emerald-500 w-full h-[70%] rounded-t-lg"></div>
                        </div>
                    </div>
                </div>

                <div class="glass-card p-5">
                    <h4 class="text-xs font-black text-slate-400 uppercase mb-4 tracking-widest">Audit Logs</h4>
                    <div class="space-y-3">
                        ${listings.map(l => `
                            <div class="flex items-center justify-between text-[11px] border-b border-slate-50 pb-2">
                                <span class="font-bold text-slate-700">${l.name}</span>
                                <span class="font-black ${l.status === 'Claimed' ? 'text-emerald-500' : 'text-orange-500'}">${l.status.toUpperCase()}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>
        `;
    }

    // --- Helpers ---
    function renderCards(isDonor) {
        return listings.filter(l => isDonor || l.status === 'Open').map(l => {
            const color = l.quality >= 75 ? 'bg-emerald-500' : (l.quality >= 50 ? 'bg-orange-500' : 'bg-red-500');
            return `
                <div class="glass-card p-4 relative overflow-hidden">
                    ${l.night ? '<div class="absolute top-0 right-0 p-1 bg-blue-600 text-[8px] text-white font-black px-3 rounded-bl-xl"><i class="fa-solid fa-moon mr-1"></i>NIGHT</div>' : ''}
                    <div class="flex justify-between items-start mb-2">
                        <span class="quality-tag text-white ${color}">${l.quality}% Quality</span>
                    </div>
                    <h4 class="font-bold text-slate-800 text-sm">${l.name}</h4>
                    <div class="flex items-center text-[10px] text-slate-500 font-bold mt-1">
                        <span class="mr-3"><i class="fa-solid fa-box mr-1"></i>${l.qty}</span>
                        <span><i class="fa-solid fa-location-dot mr-1"></i>${l.loc}</span>
                    </div>
                    ${!isDonor && l.status === 'Open' ? `
                        <button onclick="handleClaim(${l.id})" class="mt-3 w-full py-2 bg-slate-800 text-white rounded-xl text-[10px] font-black uppercase">Secure Pickup</button>
                    ` : ''}
                </div>
            `;
        }).join('');
    }

    function showModal(title, msg, isConfirm = false) {
        return new Promise(resolve => {
            const m = document.createElement('div');
            m.className = "fixed inset-0 bg-slate-900/90 z-[200] flex items-center justify-center p-8";
            m.innerHTML = `
                <div class="bg-white rounded-[40px] p-8 w-full max-w-[320px] shadow-2xl scale-in">
                    <h3 class="text-xl font-black text-slate-800 mb-2">${title}</h3>
                    <div class="text-sm text-slate-500 leading-relaxed mb-8">${msg}</div>
                    <div class="flex gap-3">
                        <button id="m-ok" class="flex-1 py-4 bg-emerald-600 text-white rounded-2xl font-bold">ACCEPT</button>
                        ${isConfirm ? '<button id="m-no" class="flex-1 py-4 bg-slate-100 text-slate-500 rounded-2xl font-bold">DECLINE</button>' : ''}
                    </div>
                </div>
            `;
            document.body.appendChild(m);
            document.getElementById('m-ok').onclick = () => { m.remove(); resolve(true); };
            if(isConfirm) document.getElementById('m-no').onclick = () => { m.remove(); resolve(false); };
        });
    }

    // Boot
    switchView('donor');
</script>

</body>
</html>

